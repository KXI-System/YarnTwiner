window.storyFormat({"name":"YarnTwiner","version":"0.1.0","author":"Khan-ali Ibrahim (KXI System)","description":"The Twine story format that lets you write and export to Yarn!","image":"","url":"","license":"MIT License","proofing":false,"source":"<!doctype html><html><head><meta name=\"viewport\" content=\"width=device-width,initial-scale=1\"><meta charset=\"utf-8\"><title>{{STORY_NAME}} - YarnTwiner</title><style type=\"text/css\">body{margin:auto;max-width:50em;padding:1em}tw-storydata{display:none}.code{background-color:#d3d3d3;font-family:monospace;margin:0;padding:.5em;white-space:pre-wrap}</style></head><body>{{STORY_DATA}}<div class=\"content\"><h1>{{STORY_NAME}} - YarnTwiner</h1><p>Thanks for using YarnTwiner, below is your story converted into a yarn script. Remember, YarnTwiner can't check if the yarn script is valid or not!</p><hr></div><div class=\"file\"><p class=\"download\"><button>Download</button> &nbsp;{{STORY_NAME}}.yarn</p><pre class=\"code\"></pre></div><script defer=\"defer\">(()=>{\"use strict\";window.addEventListener(\"load\",(async function(){const e=document.querySelectorAll(\"tw-storydata > tw-passagedata\");const t=function(e,t=!1){return e.sort(((e,t)=>e.order-t.order)).reduce(((e,n)=>{if(n.ignore&&!t)return e;if(n.raw)return`${e}${n.content}\\n\\n`;let r=n.attributes.reduce(((e,t)=>(e.push(`${t.name}: ${t.value}`),e)),[]);return`${e}title: ${n.name}\\n${r.join(\"\\n\")}\\nposition: ${n.position}\\n---\\n${n.content}\\n===\\n\\n`}),\"\")}(Object.values(e).map((e=>{let t=!1,n=!1,r=!1,i=0,a=e.attributes.name.value;a=a.replace(/[\\s\\.]/g,\"_\");let o=e.attributes.tags.value.split(\" \").map((e=>{if(e.includes(\"@\"))return\"@raw\"===e&&(t=!0),\"@comment\"===e&&(r=!0),\"@ignore\"===e&&(n=!0),void(e.includes(\"@order\")&&(i=Number(e.split(\":\")[1])));if(e.includes(\"&\")){let t=e.slice(1).replace(\"-\",\" \").split(\":\");return{name:t[0].trim(),value:t[1].trim()}}return{name:\"tags\",value:e}}));o=o.reduce(((e,t)=>{if(void 0===t)return e;let n=e.findIndex((e=>e.name===t.name));return-1!==n?e[n].value+=\" \"+t.value:e.push(t),e}),[]);let u=e.attributes.position.value,l=e.innerHTML;return l=l.replace(/\\[\\[(.*?)\\]\\]/g,((e,t)=>`&lt;&lt;jump ${t}&gt;&gt;`)),r&&(l=l.replace(/^/gm,\"//\")),{name:a,attributes:o,position:u,content:l,raw:t,ignore:n,order:i}}))),n=this.document.querySelector(\".code\");n.innerHTML=t,this.document.querySelector(\".download > button\").addEventListener(\"click\",(e=>{!function(e,t){let n=new File([e],t,{type:\"application/octet-stream\"}),r=document.createElement(\"a\");r.href=window.URL.createObjectURL(n),r.download=n.name,document.body.appendChild(r),r.dispatchEvent(new MouseEvent(\"click\",{bubbles:!0,cancelable:!0,view:window})),r.remove(),window.URL.revokeObjectURL(r.href)}(n.innerText,\"output.yarn\")}))}))})();</script></body></html>"});