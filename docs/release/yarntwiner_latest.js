window.storyFormat({"name":"YarnTwiner","version":"latest","author":"Khan-ali Ibrahim (KXI System)","description":"The Twine story format that lets you write and export to Yarn!","image":"https://kxi-system.github.io/YarnTwiner/logo.png","url":"https://github.com/KXI-System/YarnTwiner","license":"MIT License","proofing":false,"source":"<!doctype html><html><head><meta name=\"viewport\" content=\"width=device-width,initial-scale=1\"><meta charset=\"utf-8\"><title>{{STORY_NAME}} - YarnTwiner</title><style type=\"text/css\">body{margin:auto;max-width:60em;padding:1em}tw-storydata{display:none}.download{float:right}.code{background-color:#d3d3d3;font-family:monospace;margin:0;padding:.5em;white-space:pre-wrap}</style></head><body>{{STORY_DATA}}<div class=\"content\"><h1>{{STORY_NAME}} - YarnTwiner</h1><p>Thanks for using YarnTwiner, below is your story converted into a yarn script. Remember, YarnTwiner can't check if the yarn script is valid or not!</p><hr></div><div class=\"file\"><p><span class=\"name\">{{STORY_NAME}}</span> <button class=\"download\">Download Yarn</button></p><pre class=\"code\"></pre></div><script defer=\"defer\">(()=>{\"use strict\";window.addEventListener(\"load\",(async function(){const e=document.querySelectorAll(\"tw-storydata\")[0],t=Object.values(document.querySelectorAll(\"tw-storydata > tw-passagedata\"));const n=function(e,t=!1){return e.sort(((e,t)=>e.order-t.order)).reduce(((e,n)=>{if(n.ignore&&!t)return e;if(n.raw)return`${e}${n.content}\\n\\n`;let r=n.headers.reduce(((e,t)=>(e.push(`${t.name}: ${t.value}`),e)),[]);return`${e}title: ${n.name}\\n${r.join(\"\\n\")}\\n---\\n${n.content}\\n===\\n\\n`}),\"\")}(t.map((e=>{let t={name:\"\",headers:[],content:\"\",raw:!1,ignore:!1,order:0},n=!1,r=e.attributes.name.value;t.name=r.replace(/[\\s\\.]/g,\"_\");let a=e.attributes.tags.value.split(\" \");t.headers=a.reduce(((e,r)=>{if(!r)return e;if(r.includes(\"@\"))return\"@raw\"===r&&(t.raw=!0),\"@comment\"===r&&(n=!0),\"@ignore\"===r&&(t.isComment=!0),r.includes(\"@order\")&&(t.order=Number(r.split(\":\")[1])),e;let a=\"tags\",o=\"\";if(r.includes(\"&\")){let e=r.slice(1).replace(\"-\",\" \").split(\":\");a=e[0],o=e[1]}let i=e.findIndex((e=>e.name===a));return-1!==i?e[i].value+=\" \"+o:e.push({name:a.trim(),value:o.trim()}),e}),[]);let o=e.attributes.position.value;t.headers.push({name:\"position\",value:o});let i=e.innerText;return t.content=i.replace(/\\[\\[(.*?)\\]\\]/g,((e,t)=>`<<jump ${t}>>`)),n&&(t.content=t.content.replace(/^/gm,\"//\")),t}))),r=this.document.querySelector(\".code\");r.innerText=n,this.document.querySelector(\".download\").addEventListener(\"click\",(t=>{!function(e,t){let n=new File([e],t,{type:\"application/octet-stream\"}),r=document.createElement(\"a\");r.href=window.URL.createObjectURL(n),r.download=n.name,document.body.appendChild(r),r.dispatchEvent(new MouseEvent(\"click\",{bubbles:!0,cancelable:!0,view:window})),r.remove(),window.URL.revokeObjectURL(r.href)}(r.innerText,e.attributes.name.value+\".yarn\")}))}))})();</script></body></html>"});